## Tappa 16 — Implementazione degli effetti mancanti

Questa tappa integra e rifinisce diversi effetti del deck Blue-Eyes e la relativa UX.

### Novità principali
- Finestra di risposta/chain (da Tappa 15, rifinita):
	- Si apre automaticamente su eventi rilevanti (evocazioni, attacchi, ecc.).
	- Mostra solo le carte attivabili del giocatore locale (P1) e si chiude prima dei pannelli modali.
	- La chain risolve LIFO; il Pass chiude la chain quando tutti passano.
- Regola di attivazione M/T: una Trappola Continua non può essere riattivata se è già scoperta.

### Effetti implementati/rifiniti

1) La Melodia del Drago che si Risveglia
- Attivazione consentita se il proprietario ha almeno 1 carta in mano da scartare e nel Deck almeno un Drago con ATK ≥ 3000 e DEF ≤ 2500.
- Flusso interattivo:
	- P1 (umano): seleziona una carta in mano da scartare cliccandola; si apre il pannello di scelta dal Deck filtrato (Draghi 3000/2500).
	- È possibile aggiungere fino a 2 carte alla mano nella stessa risoluzione; il pannello resta aperto per la seconda scelta. ESC termina la selezione anticipatamente.
	- P2 (AI): scarta casualmente una carta dalla mano, poi sceglie casualmente i bersagli validi dal Deck.
- UX: il pannello mostra un titolo dedicato per l’aggiunta in mano e un hint che indica la possibilità di fare due scelte.

2) Richiamo del Posseduto (semplificato)
- Attivazione consentita se il proprietario ha almeno un Mostro nel proprio Cimitero e spazio libero in zona Mostri.
- Flusso interattivo al momento dell’attivazione:
	- P1 (umano): si apre un pannello di scelta che mostra solo i Mostri nel proprio Cimitero con titolo “Scegli il mostro da evocare”. Dopo la selezione, il Mostro viene Evocato Specialmente in Posizione di Attacco (scoperta).
	- P2 (AI): seleziona casualmente un Mostro dal proprio Cimitero e lo evoca.
- Nota: il comportamento “link” della Continua (distruggere il Mostro se la Trappola lascia il Terreno) è marcato come follow-up e non è ancora implementato in questa tappa.

3) Rivali Predestinati (semplificato)
- Effetto di negazione a durata turno gestito tramite helper sul Game; integrato nel sistema eventi/chain.

### Migliorie UI/UX e rendering
- Pannelli modali: si chiude sempre il prompt di risposta prima di aprirli, per evitare interferenze con i click.
- Pannello riuso e mappatura indici: lo stesso overlay di scelta è riutilizzato per Deck e Cimitero; quando la lista mostrata è filtrata (es. solo Mostri), viene gestita una mappatura indici UI → sorgente reale per risolvere correttamente la scelta.
- Carte in mano: rendering con texture frontali corrette e mantenimento della dimensione originale dopo lo swap di texture.

### Controlli rapidi
- Overlay di scelta (Deck/Cimitero):
	- Invio = Conferma la selezione corrente
	- ESC = Annulla / termina la selezione (per Melodia, chiude dopo la 1ª scelta se non si desidera la 2ª)
	- Frecce o Click = Cambia selezione
- Scarto dalla mano (Melodia): clicca la carta in mano da scartare quando richiesto.
- Prompt di risposta (chain): seleziona una carta attivabile e conferma; ESC passa la priorità (auto-pass dell’AI per risolvere la chain in demo).

### Comportamento dell’AI (P2)
- Scelte casuali per: scarto dalla mano, aggiunta dal Deck con Melodia, invio dal Deck (reliquiari/draghi), e selezione dal Cimitero con Richiamo del Posseduto.

### Limitazioni e prossimi passi
- Richiamo del Posseduto: non è ancora attivo il legame continuo “se la Trappola lascia il Terreno, distruggi quel Mostro”.
- Testi del pannello: alcuni hint sono generici e possono essere ulteriormente personalizzati per ogni effetto.

### Note di build/esecuzione
- Target: `mainTappa16` (vedi cartella `build/bin`).