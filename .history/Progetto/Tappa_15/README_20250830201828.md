## Tappa 15 — Changelog delle modifiche funzionali

Dopo aver sistemato un minimo il codice, in questa tappa cerco di fixare tutte le problematiche individuate all'interno del gioco fin'ora, e successivamente di implementare una prima bozza di EffectChain

**Risoluzione Sincronizzazione del deck**
Spesso capitava che usando degli effetti che modificano il numero di carte nel deck, quest'ultimi funzionassero anche se la carta scelta non era più presente all'interno del deck stesso.
Ho quindi fatto in modo di sincronizzare correttamente il deck, con tutte le modifiche che gli vengono fatte:

**Modifiche principali**

- `Player` adesso memorizza un puntatore al proprio `Deck` invece di copiarne il contenuto.
  - Scopo: evitare copie accidentali del Deck che causavano differenze tra logica e UI.

- `Game` modifica del metodo per associare il deck al gioco:
  - `attachExternalDeck(Deck*, int)` adesso non prende più come parametro solo il puntatore a deck, ma anche l'indice del player, in modo da non rischiare di avere un unico puntatore per 2 deck.
  - Internamente `Game` conserva `externalDecks[2]` (un array con 2 puntatori a oggetti Deck differenti).
  - `Game::mirrorExternalDeckRemoveByName(const std::string&, const Deck*)` adesso riceve il `sourceDeck` per evitare "double-remove" quando la sorgente della rimozione è già la stessa istanza grafica.
  - Decisione sul deck-out, la condizione di deck-out ora usa lo stato logico del gioco (es. `current().canDraw()`), non lo stato visivo dell'UI.
  - Questo evita vittorie errate dovute a disallineamenti temporanei tra UI e logica.

- `Overlays` (Graveyard / ExtraDeck)
  - Implementata funzione `reset()` che pulisce cache interne, selezioni e bounding boxes.
  - `main.cpp` è stato aggiornato per chiamare i `reset()` appropriati durante `resetMatch` (prima e dopo la ricreazione dei Deck) per evitare residui grafici tra le partite.

- Aggiornamento anche dei file che chiamano i metodi modificati:
  - `GameWiring` ora registra effetti di default, attacca i Deck esterni (`attachExternalDeck`) e collega il `DrawController` al `Game`.
  - `AppHandlers` è stato aggiornato per usare i nuovi hook di sincronizzazione (event handlers: DrawStart/DrawEnd, NormalSummon, CardMoved, ecc.).
  - `main.cpp` aggiorna `resetMatch` per ricreare deck e resettare overlay in modo sicuro.

### File principali modificati
- `GameLogic/Player/Player.h` — Player ora contiene `Deck*` non-owning.
- `GameLogic/Game/Game.h` / `Game.cpp` — `externalDecks`, `attachExternalDeck`, `mirrorExternalDeckRemoveByName`, deck-out logic.
- `GameLogic/DrawController/DrawController.cpp` — gestione animazioni pesca e `reset()`.
- `GraveyardOverlay/*`, `ExtraDeckOverlay/*` — stato `reset()` per cancellare cache UI.
- `GameWiring/GameWiring.cpp` — inizializzazione effetti, attach deck/draw controller.
- `AppHandlers/AppHandlers.cpp` — wiring degli eventi verso le callback UI.
- `main.cpp` — `resetMatch` aggiornato per ricreare deck, resettare overlay e riallocare le risorse necessarie.

**Modifica degli Effetti carte**
- Gli effect handlers delle carte `Pietra bianca della leggenda` e `pietra bianca degli antichi` sono stati adattati per chiamare `mirrorExternalDeckRemoveByName(...)` passando il puntatore al deck sorgente, così da mantenere sincronizzate il numero di carte del deck con gli effetti chiamati Deck UI senza double-remove.

- Correzione effetto `Pietra bianca della leggenda`:
  - Quando l'effetto di "Pietra Bianca della Leggenda" aggiungeva un "Drago Bianco Occhi Blu" dal Deck alla mano, la carta appariva con la texture del retro perché il percorso effetto bypassava il `DrawController` (che normalmente applica la texture frontale). Per risolvere il problema adesso `WhiteStoneLegendEffect` riceve un riferimento a `TextureManager` e chiama `RenderUtils::applyFrontTextureIfAny(...)` prima di aggiungere la carta alla mano. Questo garantisce che la carta inserita dalla logica dell'effetto abbia la texture frontale corretta. Il passaggio di Texture avviene tramite `GameWiring`/`main.cpp` --> ho quindi aggiornato il metodo registerDefaultEffects() in GameWiring.
