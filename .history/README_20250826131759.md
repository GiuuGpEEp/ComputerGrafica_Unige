# CMake SFML Project Template

This repository template should allow for a fast and hassle-free kick start of your next SFML project using CMake.
Thanks to [GitHub's nature of templates](https://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-repository-from-a-template), you can fork this repository without inheriting its Git history.

The template starts out very basic, but might receive additional features over time:

- Basic CMake script to build your project and link SFML on any operating system
- Basic [GitHub Actions](https://github.com/features/actions) script for all major platforms
````markdown
# Progetto FCG — Tappa 13 (SFML + C++)

> Implementazione di un prototipo di gioco di carte con motore regole, UI e IA base.

Questo README riassume le funzionalità attuali, i controlli, come costruire ed eseguire il target della Tappa 13 e le principali migliorie introdotte di recente.

## Stato attuale (highlights)

- Turni/Fasi completi, pesca e condizioni di vittoria (LP ≤ 0 o deck out) con overlay Game Over.
- Pescata iniziale alternata: P1, P2, P1, P2… fino a 5 carte ciascuno, sincronizzata con animazioni.
- Animazioni di pescata differenziate:
   - P1: rivelazione al centro con possibilità di “click-to-skip”.
   - P2: nessuna rivelazione; la carta va direttamente dal Deck alla mano con texture retro.
- Motore Magie/Trappole (M/T):
   - 3 slot M/T per giocatore + 1 slot Campo dedicato (Field Spell); sostituzione invia la precedente al Cimitero.
   - Regole di set/attivazione: Trappole non attivabili dalla mano; Trap e Magie Rapide settate non attivabili nello stesso turno; Continue restano sul campo.
   - Attivazione da coperta nel proprio/avversario turno rispettando i vincoli di timing.
- Mostri e Tribute Summon:
   - Evocazione/Posa con scelta esplicita dello slot; mappatura “per slot” stabile per evitare shift visivi.
   - Tribute Summon consentita anche con tutte le zone piene: i tributi liberano spazio e il mostro viene collocato nello slot scelto (se libero dopo i tributi) o nel primo libero.
- Battaglia: confronto ATK vs DEF corretto; con valori uguali in DEF non si distrugge nessuno e non si infligge danno.
- Prompt di risposta (finestra modale) per attivare Trap/Magie Rapide:
   - Si apre automaticamente nelle finestre di timing del turno avversario (cambio fase, dichiarazione attacco, ecc.).
   - Mostra solo le carte attivabili del giocatore locale (P1). L’IA (P2) resta in pausa mentre il prompt è aperto.
- Scelte automatiche P2: su evocazioni speciali con scelta posizione, P2 risolve da sé senza chiedere input a P1.
- IA base per P2: evoca, attiva magie semplici, setta M/T, attacca con priorità bersagli deboli.

## Controlli principali

- Trascinamento dalla mano su zona Mostri: scelta “E = Evoca, P = Posiziona”.
- Trascinamento di Magie/Trappole su zona M/T o slot Campo: “A = Attiva, S = Setta”.
- Attivazione da coperta: tasto “X” sulla propria carta M/T coperta (rispetta i vincoli di timing).
- Cambio posizione Mostro: tasto “C” (flip a scoperto o ATK⇄DEF con limiti di turno).
- Prompt risposta (durante il turno avversario): frecce per scegliere, Invio per attivare, Esc per chiudere.
- Pescata di P1: click del mouse per saltare l’attesa al centro.

## Regole chiave (motore)

- M/T: 3 slot per lato + Field Spell dedicata; Trap non dalla mano; Rapide/Trap settate non attivabili nello stesso turno; Continue restano in campo.
- Reset vincoli set/attivazione: le carte M/T settate nel proprio turno diventano attivabili già dal turno avversario successivo.
- Evocazioni slot-aware: lo slot scelto in UI viene rispettato anche dopo tributi; rendering stabile per-slot.
- Tribute Summon con zona piena: possibile se si hanno i tributi richiesti (livello 5–6: 1; 7+: 2). Lo slot si libera prima del piazzamento.
- Battaglia: gestione attacchi sequenziali, marcatura “ha attaccato”, regola ATK vs DEF con pareggio senza distruzioni/danni.

## IA (Player 2)

- Aggiornata solo quando non ci sono animazioni di pescata in corso e quando non c’è un prompt aperto.
- Flusso standard: evoca mostri bassi in Main1, prova magie semplici, attacca in Battle, setta M/T e Field in Main2, chiude il turno.
- Scelte automatizzate per non bloccare l’UX di P1 (es. posizione su Special Summon).

## Build ed esecuzione

Il progetto usa CMake (con FetchContent) e SFML 3.

- Target principali in questa tappa: `mainTappa13` (UI completa con M/T, prompt e IA). Sono presenti anche target per tappe precedenti (`mainTappa1..12`).
- Con VS Code: apri la cartella del progetto, usa l’estensione CMake per configurare e costruire, quindi avvia il target `mainTappa13` (Release consigliato).
- Da riga di comando (facoltativo):
   - Configurazione: cmake -B build
   - Build: cmake --build build --target mainTappa13 --config Release

Le risorse (texture, font, dati) sono sotto `Progetto/resources` e le sorgenti della tappa in `Progetto/Tappa_13` (entry point: `Progetto/Tappa_13/main.cpp`).

## Eventi e infrastruttura effetti (sintesi)

- Eventi base: DrawStart/DrawEnd, TurnStart/TurnEnd, PhaseChange, AttackDeclared/Resolved, CardMoved, CardSentToGrave, LifePointsChanged, Win/Lose.
- M/T: SpellSet, TrapSet, SpellActivated, TrapActivated.
- Scelte effetto: richieste/risoluzioni per Special Summon con scelta posizione e invii dal Deck; la UI effettua mirroring grafico del Deck quando effetti lo modificano.

## Migliorie recenti (QoL/bugfix)

- Stabilità rendering lato P2 (mano/deck sempre visibili; texture retro, rotazioni corrette).
- Mappatura slot Mostri stabile per eliminare “scivolamenti” dopo distruzioni.
- Mirroring del Deck UI quando effetti rimuovono carte.
- Gating corretto del prompt: visibile solo per P1 nel turno di P2; IA in pausa durante il prompt.
- Guardie su pescata iniziale per evitare doppie pescate.

---

Note: per dettagli tecnici approfonditi della Tappa 13 (API, eventi e implementazione), consulta anche `Progetto/Tappa_13/README.md`.
````

